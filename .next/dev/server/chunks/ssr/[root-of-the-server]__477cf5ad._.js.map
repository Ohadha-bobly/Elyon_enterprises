{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GEOFFREY/Desktop/Elyon_2/app/dashboard/billing/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { createBrowserClient } from '@supabase/ssr'\n\ninterface Transaction {\n  id: string\n  amount: number\n  payment_method: string\n  status: string\n  created_at: string\n  user: { email: string }\n}\n\nexport default function BillingPage() {\n  const [transactions, setTransactions] = useState<Transaction[]>([])\n  const [loading, setLoading] = useState(true)\n  const [stats, setStats] = useState({\n    totalRevenue: 0,\n    pendingPayments: 0,\n    failedPayments: 0,\n  })\n\n  const supabase = createBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n  )\n\n  useEffect(() => {\n    fetchData()\n  }, [])\n\n  const fetchData = async () => {\n    try {\n      setLoading(true)\n\n      // Fetch transactions\n      const { data: txData } = await supabase\n        .from('transactions')\n        .select('*, user:users(email)')\n        .order('created_at', { ascending: false })\n        .limit(50)\n\n      setTransactions(txData || [])\n\n      // Calculate stats\n      const completed = txData?.filter(t => t.status === 'completed') || []\n      const pending = txData?.filter(t => t.status === 'pending') || []\n      const failed = txData?.filter(t => t.status === 'failed') || []\n\n      setStats({\n        totalRevenue: completed.reduce((sum, t) => sum + t.amount, 0),\n        pendingPayments: pending.reduce((sum, t) => sum + t.amount, 0),\n        failedPayments: failed.reduce((sum, t) => sum + t.amount, 0),\n      })\n    } catch (error) {\n      console.error('Error fetching data:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold text-foreground\">Billing & Payments</h1>\n        <p className=\"text-muted mt-2\">Transaction history and financial reports</p>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <div className=\"bg-card border border-border rounded-xl p-6\">\n          <p className=\"text-muted text-sm mb-2\">Total Revenue</p>\n          <p className=\"text-3xl font-bold text-success\">KES {(stats.totalRevenue / 1000).toFixed(0)}K</p>\n        </div>\n        <div className=\"bg-card border border-border rounded-xl p-6\">\n          <p className=\"text-muted text-sm mb-2\">Pending Payments</p>\n          <p className=\"text-3xl font-bold text-warning\">KES {(stats.pendingPayments / 1000).toFixed(0)}K</p>\n        </div>\n        <div className=\"bg-card border border-border rounded-xl p-6\">\n          <p className=\"text-muted text-sm mb-2\">Failed Payments</p>\n          <p className=\"text-3xl font-bold text-error\">KES {(stats.failedPayments / 1000).toFixed(0)}K</p>\n        </div>\n      </div>\n\n      {/* Transactions Table */}\n      <div className=\"bg-card border border-border rounded-xl overflow-hidden\">\n        <div className=\"p-6 border-b border-border\">\n          <h2 className=\"text-lg font-semibold text-foreground\">Recent Transactions</h2>\n        </div>\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead>\n              <tr className=\"border-b border-border\">\n                <th className=\"px-6 py-3 text-left text-sm font-semibold text-foreground\">User</th>\n                <th className=\"px-6 py-3 text-left text-sm font-semibold text-foreground\">Amount</th>\n                <th className=\"px-6 py-3 text-left text-sm font-semibold text-foreground\">Method</th>\n                <th className=\"px-6 py-3 text-left text-sm font-semibold text-foreground\">Status</th>\n                <th className=\"px-6 py-3 text-left text-sm font-semibold text-foreground\">Date</th>\n              </tr>\n            </thead>\n            <tbody>\n              {transactions.map((tx) => (\n                <tr key={tx.id} className=\"border-b border-border last:border-0 hover:bg-card-hover\">\n                  <td className=\"px-6 py-4 text-sm text-foreground\">{tx.user?.email}</td>\n                  <td className=\"px-6 py-4 text-sm font-semibold text-foreground\">KES {tx.amount.toLocaleString()}</td>\n                  <td className=\"px-6 py-4 text-sm text-foreground capitalize\">{tx.payment_method}</td>\n                  <td className=\"px-6 py-4 text-sm\">\n                    <span className={`px-2 py-1 rounded text-xs font-semibold ${\n                      tx.status === 'completed'\n                        ? 'bg-success/20 text-success'\n                        : tx.status === 'pending'\n                        ? 'bg-warning/20 text-warning'\n                        : 'bg-error/20 text-error'\n                    }`}>\n                      {tx.status.toUpperCase()}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 text-sm text-muted\">\n                    {new Date(tx.created_at).toLocaleDateString()}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}